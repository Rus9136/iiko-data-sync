# PROJECT_STATE.md

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 27 –º–∞—è 2025, 23:00 UTC+6
**–í–µ—Ä—Å–∏—è:** v1.3.0 - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
iiko-data-sync/
‚îú‚îÄ‚îÄ config/                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ config.py               # API –∏ DB –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ src/                        # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ models.py               # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ api_client.py           # IIKO API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ synchronizer.py         # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ sales_synchronizer.py   # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂
‚îÇ   ‚îú‚îÄ‚îÄ store_synchronizer.py   # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∫–ª–∞–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ department_synchronizer.py  # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Ç–¥–µ–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ price_synchronizer.py   # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ü–µ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ supplier_synchronizer.py    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ incoming_invoice_synchronizer.py  # –ü—Ä–∏—Ö–æ–¥–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ
‚îú‚îÄ‚îÄ web/                        # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ app.py                  # Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ static/                 # CSS –∏ JS —Ä–µ—Å—É—Ä—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ templates/              # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ reports/                # üÜï –ú–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ migrations/                 # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ main.py                     # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îî‚îÄ‚îÄ run_web.py                  # –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
```

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
```
–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
‚îú‚îÄ‚îÄ products (170K+ –∑–∞–ø–∏—Å–µ–π)     # –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞
‚îú‚îÄ‚îÄ sales (170K+ –∑–∞–ø–∏—Å–µ–π)        # –ü—Ä–æ–¥–∞–∂–∏ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º
‚îú‚îÄ‚îÄ stores                       # –°–∫–ª–∞–¥—ã/–º–∞–≥–∞–∑–∏–Ω—ã
‚îú‚îÄ‚îÄ departments                  # –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ suppliers                    # –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏
‚îú‚îÄ‚îÄ accounts                     # –°—á–µ—Ç–∞ —É—á–µ—Ç–∞
‚îú‚îÄ‚îÄ writeoff_documents          # –î–æ–∫—É–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∞–Ω–∏—è
‚îú‚îÄ‚îÄ writeoff_items              # –ü–æ–∑–∏—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏–π
‚îú‚îÄ‚îÄ incoming_invoices           # –ü—Ä–∏—Ö–æ–¥–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ
‚îú‚îÄ‚îÄ incoming_invoice_items      # –ü–æ–∑–∏—Ü–∏–∏ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö
‚îú‚îÄ‚îÄ prices                      # –¶–µ–Ω—ã –ø–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º
‚îî‚îÄ‚îÄ sync_log                    # –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### 1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- **API –∫–ª–∏–µ–Ω—Ç:** Hash-based –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è IIKO API
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å upsert –ª–æ–≥–∏–∫–æ–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** Graceful degradation —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è:** 4000 –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∑–∞–ø—Ä–æ—Å

#### 2. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
- **Backend:** Flask —Å SQLAlchemy ORM
- **Frontend:** Bootstrap 5 + AJAX –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ú–æ–¥—É–ª—å–Ω–∞—è —Å Blueprint'–∞–º–∏
- **–ë–∞–∑–∞:** PostgreSQL —Å —Å–æ—Å—Ç–∞–≤–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏

#### 3. **–ú–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ (NEW)**
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Flask Blueprint —Å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** JSON-based —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- **–î–∞–Ω–Ω—ã–µ:** CTE –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
- **–≠–∫—Å–ø–æ—Ä—Ç:** Excel —Å pandas + xlsxwriter

## üìà –ù–µ–¥–∞–≤–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ö—Ä—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã):

#### **2025-05-27: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥—É–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ [ea3223d]**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ 6 —Ç–∏–ø–æ–≤ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –≤–º–µ—Å—Ç–æ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ—á–µ–∫
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã: –ø–æ—á–∞—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏, —Ç–æ–ø —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã SQL –æ—à–∏–±–∫–∏ (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏, JOIN –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏

#### **2025-05-26: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ [4bd3036]**
- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Blueprint
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –ø–æ –æ—Ç–¥–µ–ª–∞–º —á–µ—Ä–µ–∑ JOIN
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel
- ‚úÖ CTE –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

#### **2025-05-25: –û—á–∏—Å—Ç–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ [4d242be]**
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ –æ—Ç—á–µ—Ç—ã –∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–≤–æ–¥–∫–∏
- ‚úÖ –û—á–∏—â–µ–Ω–∞ –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞ –æ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

#### **2025-05-24: –£–ª—É—á—à–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ [5a0e745]**
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ AJAX –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **–¢–∏–ø—ã –æ—Ç—á–µ—Ç–æ–≤:** 6 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–∏–ø –æ—Ç—á–µ—Ç–∞
- **–ì—Ä–∞—Ñ–∏–∫–∏:** –õ–∏–Ω–µ–π–Ω—ã–µ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** SQL —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, JOIN –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —ç–∫—Å–ø–æ—Ä—Ç Excel

## üéØ –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. **–ú–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Å–ø–∏—Å–∞–Ω–∏—è–º** üî•
   - –û—Ç—á–µ—Ç "–°–ø–∏—Å–∞–Ω–∏—è –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º" —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –¥–∞—Ç–∞–º
   - –û—Ç—á–µ—Ç "–°–ø–∏—Å–∞–Ω–∏—è –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º" –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ç–µ—Ä—å
   - –û—Ç—á–µ—Ç "–°–ø–∏—Å–∞–Ω–∏—è –ø–æ —Ç–æ–≤–∞—Ä–∞–º" - —Ç–æ–ø —Å–ø–∏—Å—ã–≤–∞–µ–º—ã—Ö –ø–æ–∑–∏—Ü–∏–π
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç—á–µ—Ç–æ–≤** üî•
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (Redis/in-memory)
   - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç—á–µ—Ç–æ–≤** üî∂
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ LocalStorage/URL
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ –≤ –æ–¥–Ω–æ–º –æ—Ç—á–µ—Ç–µ
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF —Ñ–æ—Ä–º–∞—Ç

4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏—Ö–æ–¥–Ω—ã–º–∏ –Ω–∞–∫–ª–∞–¥–Ω—ã–º–∏** üî∂
   - –û—Ç—á–µ—Ç—ã –ø–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤
   - –ê–Ω–∞–ª–∏–∑ –∑–∞–∫—É–ø–æ—á–Ω—ã—Ö —Ü–µ–Ω
   - –°–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
5. **–î–∞—à–±–æ—Ä–¥—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** üî∏
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤ (pie, radar, heatmap)
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –≤–∏–¥–∂–µ—Ç—ã –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

6. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** üî∏
   - –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ—Ç—á–µ—Ç–∞–º
   - –ê—É–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
   - API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

## ‚ö†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
1. **–°–≤—è–∑–∏ –¥–∞–Ω–Ω—ã—Ö** üö®
   - **–ü—Ä–æ–±–ª–µ–º–∞:** `sales.department_id` —á–∞—Å—Ç–æ NULL, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è
   - **–í–ª–∏—è–Ω–∏–µ:** –ù–µ—Ç–æ—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ—Ç–¥–µ–ª–∞–º
   - **–†–µ—à–µ–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è department_id –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤** üö®
   - **–ü—Ä–æ–±–ª–µ–º–∞:** CTE –∑–∞–ø—Ä–æ—Å—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ –Ω–∞ 170K+ –∑–∞–ø–∏—Å—è—Ö
   - **–í–ª–∏—è–Ω–∏–µ:** –¢–∞–π–º-–∞—É—Ç—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤
   - **–†–µ—à–µ–Ω–∏–µ:** –ò–Ω–¥–µ–∫—Å—ã + –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

### –í–∞–∂–Ω—ã–π
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** üî∂
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - **–í–ª–∏—è–Ω–∏–µ:** –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏, –æ—à–∏–±–∫–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ API endpoints

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** üî∂
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
   - **–í–ª–∏—è–Ω–∏–µ:** –ü–ª–æ—Ö–æ–π UX –ø—Ä–∏ —Å–±–æ—è—Ö
   - **–†–µ—à–µ–Ω–∏–µ:** Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã, —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π
5. **–ö–æ–¥ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** üî∏
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞—Ö
   - **–í–ª–∏—è–Ω–∏–µ:** –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** üî∏
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
   - **–í–ª–∏—è–Ω–∏–µ:** –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ä–µ–¥—ã

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
```
Python 3.8+
PostgreSQL 12+
Flask 2.3+
SQLAlchemy 1.4+
pandas + xlsxwriter (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞)
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```
IIKO_API_LOGIN=Tanat
IIKO_API_PASSWORD=[hash]
DB_HOST=localhost
DB_PORT=5432
DB_NAME=iiko_data
DB_USER=rus
DB_PASSWORD=[password]
```

### –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–≤ –ø–æ—Ä—è–¥–∫–µ)
psql -d iiko_data -f migrations/001_create_tables.sql
psql -d iiko_data -f migrations/002_fixed_create_products_table.sql
# ... (—Å–º. CLAUDE.md –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞)

# –ó–∞–ø—É—Å–∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
python run_web.py
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –†–∞–∑–º–µ—Ä –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã
- **Python –∫–æ–¥:** ~3000 —Å—Ç—Ä–æ–∫
- **HTML/CSS/JS:** ~2000 —Å—Ç—Ä–æ–∫
- **SQL –º–∏–≥—Ä–∞—Ü–∏–∏:** 12 —Ñ–∞–π–ª–æ–≤
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** ~500 —Å—Ç—Ä–æ–∫

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–†–∞–∑–º–µ—Ä:** ~500MB
- **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:** sales (170K), products (–∞–∫—Ç–∏–≤–Ω—ã–µ)
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 2-5 —Å–µ–∫ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** 8 —Ç–∏–ø–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** 15+ —Å—Ç—Ä–∞–Ω–∏—Ü  
- **–û—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º:** 6 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏—Ö —Ç–∏–ø–æ–≤
- **–≠–∫—Å–ø–æ—Ä—Ç:** Excel —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ì—Ä–∞—Ñ–∏–∫–∏:** –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ Chart.js –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

## üéØ –ë–ª–∏–∂–∞–π—à–∏–µ —Ü–µ–ª–∏ (—Å–ª–µ–¥—É—é—â–∏–µ 2 –Ω–µ–¥–µ–ª–∏)

1. **–ú–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Å–ø–∏—Å–∞–Ω–∏—è–º** (3 –Ω–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–∞)
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (–∏–Ω–¥–µ–∫—Å—ã + –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏** (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤)
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞–∫–ª–∞–¥–Ω—ã–º–∏** (–æ—Ç—á–µ—Ç—ã –ø–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è–º)

---

**–ü—Ä–æ–µ–∫—Ç –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–∞–∑–µ —Ä–∞–∑–≤–∏—Ç–∏—è. –ú–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

*–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏ —Å–º. —Ñ–∞–π–ª: SESSION_LOG_2025-05-27.md*